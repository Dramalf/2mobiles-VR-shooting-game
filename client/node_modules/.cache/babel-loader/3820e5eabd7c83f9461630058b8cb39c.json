{"ast":null,"code":"import { PerspectiveCamera, Scene, Vector3, WebGLRenderer, Group, Clock, Raycaster, PMREMGenerator, UnsignedByteType, LinearToneMapping } from \"three\";\nimport Stats from 'three/examples/jsm/libs/stats.module';\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader';\nimport { RGBELoader } from 'three/examples/jsm/loaders/RGBELoader';\nimport { VRButton } from 'three/examples/jsm/webxr/VRButton.js';\nimport { LightsList } from './Tlights';\nimport { helperList } from \"./THelper\";\nexport class TEngine {\n  constructor(dom, platform) {\n    this.dom = void 0;\n    this.renderer = void 0;\n    this.mixer = void 0;\n    this.pmremGenerator = void 0;\n    this.scene = void 0;\n    this.raycaster = void 0;\n    this.camera = void 0;\n    this.clock = void 0;\n    this.controls = void 0;\n    this.target = new Vector3();\n    this.model = void 0;\n    this.heart = void 0;\n    this.newEnterIndex = 0;\n    this.character = void 0;\n    this.idlist = [];\n    this.rotateStepID = void 0;\n    this.motionStepID = void 0;\n    this.platform = void 0;\n    this.stats = void 0;\n    this.dom = dom;\n    this.platform = platform;\n    this.renderer = new WebGLRenderer({\n      antialias: true\n    });\n    this.renderer.xr.enabled = true;\n    this.clock = new Clock();\n    this.renderer.shadowMap.enabled = true;\n    this.renderer.toneMapping = LinearToneMapping;\n    this.scene = new Scene();\n    const pmremGenerator = new PMREMGenerator(this.renderer); // 使用hdr作为背景色\n\n    pmremGenerator.compileEquirectangularShader();\n    this.pmremGenerator = pmremGenerator;\n    const scene = this.scene;\n    new RGBELoader().setDataType(UnsignedByteType).load('/texture/autumn_forest_04_1k.hdr', function (texture) {\n      const envMap = pmremGenerator.fromEquirectangular(texture).texture;\n      pmremGenerator.dispose();\n      console.log('here');\n      scene.environment = envMap; // 给场景添加环境光效果\n\n      scene.background = envMap; // 给场景添加背景图\n    }, () => {}, e => {\n      console.log('error in load env_texture', e);\n    });\n    this.camera = new PerspectiveCamera(60, dom.offsetWidth / dom.offsetHeight, 0.1, 1000);\n    let character = new Group();\n    character.add(this.camera);\n    this.character = character;\n    this.scene.add(this.character);\n    this.renderer.setSize(dom.offsetWidth, dom.offsetHeight, true); // 初始性能监视器\n\n    const stats = Stats();\n    const statsDom = stats.domElement;\n    this.stats = stats;\n    statsDom.style.position = 'fixed';\n    statsDom.style.top = '0';\n    statsDom.style.right = '5px';\n    statsDom.style.left = 'unset'; // let controls;\n    //   controls = new FirstPersonControls(this.camera, this.dom);\n    //   controls.lookSpeed = 0.2; //鼠标移动查看的速度\n    //   controls.movementSpeed = 20; //相机移动速度\n    //   // controls.noFly = true;\n    //   // controls.constrainVertical = true; //约束垂直\n    //   // controls.verticalMin = Math.PI / 2;\n    //   // controls.verticalMax = Math.PI / 2 + 0.0000001;\n    // this.controls = controls\n\n    const raycaster = new Raycaster();\n    this.raycaster = raycaster;\n\n    const onWindowResize = () => {\n      this.camera.aspect = window.innerWidth / window.innerHeight;\n      this.camera.updateProjectionMatrix();\n      this.renderer.setSize(dom.offsetWidth, dom.offsetHeight, true);\n    };\n\n    window.addEventListener('resize', onWindowResize);\n    this.renderer.setAnimationLoop(() => {\n      // this.controls.update(this.clock.getDelta())\n      this.camera.getWorldDirection(this.target);\n      this.renderer.render(this.scene, this.camera);\n      stats.update();\n    });\n    this.addObject(...helperList);\n    this.addObject(...LightsList);\n    dom.appendChild(this.renderer.domElement); // dom.appendChild(statsDom)\n\n    dom.appendChild(VRButton.createButton(this.renderer));\n  }\n\n  loadGun() {\n    //载入模型\n    const loader = new GLTFLoader();\n    loader.load('/mp5/scene.gltf', gltf => {\n      // this.mixer= new AnimationMixer(gltf.scene)\n      // var action=this.mixer.clipAction(gltf.animations[0])\n      // // action.timeScale=0.8\n      // action.time=4\n      gltf.scene.traverse(object => {\n        if (object.isMesh) {\n          // 修改模型的材质\n          object.castShadow = true;\n          object.frustumCulled = false; // object.receiveShadow = true;\n\n          object.material.emissive = object.material.color;\n          object.material.emissiveMap = object.material.map;\n        }\n      });\n      gltf.scene.receiveShadow = true;\n      this.model = gltf.scene;\n      this.scene.add(gltf.scene);\n      this.character.add(gltf.scene);\n      gltf.scene.position.set(5, 0, -8);\n      console.log(this.model);\n    }, () => {}, e => {\n      console.log(\"error\", e);\n    });\n  }\n\n  loadRoom() {\n    const loader = new GLTFLoader();\n    loader.load('/abandoned_factory/scene.gltf', gltf => {\n      // this.mixer= new AnimationMixer(gltf.scene)\n      // var action=this.mixer.clipAction(gltf.animations[0])\n      // // action.timeScale=0.8\n      // action.time=4\n      gltf.scene.traverse(object => {\n        if (object.isMesh) {\n          // 修改模型的材质\n          object.castShadow = true;\n          object.frustumCulled = false; // object.receiveShadow = true;\n\n          object.material.emissive = object.material.color;\n          object.material.emissiveMap = object.material.map;\n        }\n      });\n      gltf.scene.receiveShadow = true;\n      this.scene.add(gltf.scene);\n      gltf.scene.scale.set(30, 30, 30);\n      gltf.scene.position.set(0, 100, 0);\n    }, () => {}, e => {\n      console.log(\"error\", e);\n    });\n  }\n\n  addObject() {\n    for (var _len = arguments.length, object = new Array(_len), _key = 0; _key < _len; _key++) {\n      object[_key] = arguments[_key];\n    }\n\n    object.forEach(elem => {\n      this.scene.add(elem);\n    });\n  }\n\n  setRotate(a, b, g) {\n    if (g > 0) {\n      if (b < 0) {\n        b = -180 - b;\n      } else {\n        b = 180 - b;\n      }\n    }\n\n    a = a % 180;\n\n    if (g < 0) {\n      g = g + 180;\n    }\n\n    if (!this.model) return;\n    this.model.rotation.z = (90 - g + 10) / 180 * Math.PI;\n\n    if (this.platform === 'linux') {\n      if (a > 35 && a < 85) {\n        this.model.rotation.y = a / 360 * 2 * Math.PI;\n        this.camera.rotation.y = a / 360 * 2 * Math.PI;\n\n        if (this.rotateStepID > 0) {\n          clearInterval(this.rotateStepID);\n          this.rotateStepID = -1;\n        }\n      } else if (a > 85 && a < 180) {\n        if (!this.rotateStepID || this.rotateStepID < 0) {\n          this.rotateStepID = setInterval(() => {\n            this.character.rotation.y += Math.PI / 180;\n          }, 10);\n        }\n      } else if (a < 35 || a > 300) {\n        if (!this.rotateStepID || this.rotateStepID < 0) {\n          this.rotateStepID = setInterval(() => {\n            this.character.rotation.y -= Math.PI / 180;\n          }, 10);\n        }\n      }\n\n      if (b < 25 && b > -25) {\n        this.model.rotation.x = b / 360 * 2 * Math.PI;\n\n        if (this.motionStepID > 0) {\n          clearInterval(this.motionStepID);\n          this.motionStepID = -1;\n        }\n      }\n\n      if (b < -25 || b > 25) {\n        if (!this.motionStepID || this.motionStepID < 0) {\n          this.motionStepID = setInterval(() => {\n            this.character.position.x += this.target.x; // this.camera.position.x+=this.target.x;\n\n            this.character.position.z += this.target.z;\n          }, 10);\n        } // this.model.position.x+=this.target.x;\n        // this.model.position.z+=this.target.z;\n        // \n        // console.log(this.target)\n\n      } // this.model.rotation.z=(g/360*2*Math.PI);\n\n    } else {\n      this.model.rotation.y = a / 360 * 2 * Math.PI;\n\n      if (b < 25 && b > -25) {\n        this.model.rotation.x = b / 360 * 2 * Math.PI;\n\n        if (this.motionStepID > 0) {\n          clearInterval(this.motionStepID);\n          this.motionStepID = -1;\n        }\n      }\n\n      if (b < -25 || b > 25) {\n        if (!this.motionStepID || this.motionStepID < 0) {\n          this.motionStepID = setInterval(() => {\n            this.character.position.x += this.target.x; // this.camera.position.x+=this.target.x;\n\n            this.character.position.z += this.target.z;\n          }, 10);\n        } // this.model.position.x+=this.target.x;\n        // this.model.position.z+=this.target.z;\n        // \n        // console.log(this.target)\n\n      } // this.model.rotation.z=(g/360*2*Math.PI);\n\n    }\n  }\n\n  disableControls() {\n    this.controls.enabled = false;\n  }\n\n  enableControls() {\n    this.controls.enabled = true;\n  }\n\n}","map":{"version":3,"names":["PerspectiveCamera","Scene","Vector3","WebGLRenderer","Group","Clock","Raycaster","PMREMGenerator","UnsignedByteType","LinearToneMapping","Stats","GLTFLoader","RGBELoader","VRButton","LightsList","helperList","TEngine","constructor","dom","platform","renderer","mixer","pmremGenerator","scene","raycaster","camera","clock","controls","target","model","heart","newEnterIndex","character","idlist","rotateStepID","motionStepID","stats","antialias","xr","enabled","shadowMap","toneMapping","compileEquirectangularShader","setDataType","load","texture","envMap","fromEquirectangular","dispose","console","log","environment","background","e","offsetWidth","offsetHeight","add","setSize","statsDom","domElement","style","position","top","right","left","onWindowResize","aspect","window","innerWidth","innerHeight","updateProjectionMatrix","addEventListener","setAnimationLoop","getWorldDirection","render","update","addObject","appendChild","createButton","loadGun","loader","gltf","traverse","object","isMesh","castShadow","frustumCulled","material","emissive","color","emissiveMap","map","receiveShadow","set","loadRoom","scale","forEach","elem","setRotate","a","b","g","rotation","z","Math","PI","y","clearInterval","setInterval","x","disableControls","enableControls"],"sources":["/home/malf/code/game-demo/client/src/TEngine/TEngine.ts"],"sourcesContent":["import {\n  AmbientLight,\n  AxesHelper,\n  BoxBufferGeometry,\n  GridHelper,\n  RGBAFormat,\n  TextureLoader,\n  ObjectLoader,\n  DoubleSide,\n  Mesh,\n  MeshStandardMaterial,\n  PerspectiveCamera,\n  Scene,\n  Vector2,\n  Vector3,\n  WebGLRenderer,\n  MOUSE,\n  Object3D,\n  Group,\n  Clock,\n  Raycaster,\n  TetrahedronBufferGeometry,\n  VideoTexture,\n  PMREMGenerator,\n  UnsignedByteType,\n  HemisphereLight,\n  CanvasTexture,\n  AnimationMixer,\n  MeshBasicMaterial,\n  PlaneGeometry,\n  CineonToneMapping,\n  LinearToneMapping,\n  QuadraticBezierCurve3\n} from \"three\"\nimport Stats from 'three/examples/jsm/libs/stats.module'\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls'\nimport { FirstPersonControls } from 'three/examples/jsm/controls/FirstPersonControls'\nimport { PointerLockControls } from 'three/examples/jsm/controls/PointerLockControls'\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader'\nimport { RGBELoader } from 'three/examples/jsm/loaders/RGBELoader';\nimport { VRButton } from 'three/examples/jsm/webxr/VRButton.js';\nimport { LightsList } from './Tlights'\nimport { helperList } from \"./THelper\"\nexport class TEngine {\n\n  private dom: HTMLElement\n  public renderer: WebGLRenderer\n  private mixer: AnimationMixer | undefined\n  private pmremGenerator!: PMREMGenerator\n  private scene: Scene\n  private raycaster: Raycaster\n  private camera: PerspectiveCamera\n  private clock: Clock\n  private controls!: FirstPersonControls | OrbitControls\n  public target = new Vector3()\n  private model!: Group\n  private heart!: Group\n  private newEnterIndex = 0\n  private character: Group\n  private idlist = []\n  private rotateStepID!: any\n  private motionStepID!: any\n  private platform: string\n  stats: Stats\n  constructor(dom: HTMLElement, platform: string) {\n    this.dom = dom\n    this.platform = platform;\n    this.renderer = new WebGLRenderer({\n      antialias: true\n    })\n\n    this.renderer.xr.enabled = true;\n    this.clock = new Clock()\n    this.renderer.shadowMap.enabled = true;\n    this.renderer.toneMapping = LinearToneMapping\n    this.scene = new Scene()\n    const pmremGenerator = new PMREMGenerator(this.renderer); // 使用hdr作为背景色\n    pmremGenerator.compileEquirectangularShader();\n    this.pmremGenerator = pmremGenerator;\n    const scene = this.scene;\n\n    new RGBELoader()\n      .setDataType(UnsignedByteType)\n      .load('/texture/autumn_forest_04_1k.hdr', function (texture) {\n\n        const envMap = pmremGenerator.fromEquirectangular(texture).texture;\n\n        pmremGenerator.dispose();\n        console.log('here');\n        scene.environment = envMap; // 给场景添加环境光效果\n        scene.background = envMap; // 给场景添加背景图\n      }, () => { }, (e) => { console.log('error in load env_texture', e); });\n\n    this.camera = new PerspectiveCamera(60, dom.offsetWidth / dom.offsetHeight, 0.1, 1000)\n    let character = new Group();\n    character.add(this.camera);\n    this.character = character;\n    this.scene.add(this.character)\n    this.renderer.setSize(dom.offsetWidth, dom.offsetHeight, true)\n\n    // 初始性能监视器\n    const stats = Stats()\n    const statsDom = stats.domElement\n    this.stats = stats;\n    statsDom.style.position = 'fixed'\n    statsDom.style.top = '0'\n    statsDom.style.right = '5px'\n    statsDom.style.left = 'unset'\n\n\n\n    // let controls;\n\n    //   controls = new FirstPersonControls(this.camera, this.dom);\n    //   controls.lookSpeed = 0.2; //鼠标移动查看的速度\n    //   controls.movementSpeed = 20; //相机移动速度\n    //   // controls.noFly = true;\n    //   // controls.constrainVertical = true; //约束垂直\n    //   // controls.verticalMin = Math.PI / 2;\n\n    //   // controls.verticalMax = Math.PI / 2 + 0.0000001;\n\n    // this.controls = controls\n\n\n    const raycaster = new Raycaster();\n    this.raycaster = raycaster;\n    const onWindowResize = () => {\n\n      this.camera.aspect = window.innerWidth / window.innerHeight;\n      this.camera.updateProjectionMatrix();\n\n      this.renderer.setSize(dom.offsetWidth, dom.offsetHeight, true);\n\n    }\n    window.addEventListener('resize', onWindowResize);\n\n    this.renderer.setAnimationLoop(() => {\n      // this.controls.update(this.clock.getDelta())\n      this.camera.getWorldDirection(this.target)\n      this.renderer.render(this.scene, this.camera)\n      stats.update()\n    })\n\n    this.addObject(...helperList)\n    this.addObject(...LightsList)\n    dom.appendChild(this.renderer.domElement)\n    // dom.appendChild(statsDom)\n    dom.appendChild(VRButton.createButton(this.renderer))\n  }\n\n  loadGun() {\n    //载入模型\n    const loader: GLTFLoader = new GLTFLoader()\n\n    loader.load('/mp5/scene.gltf', (gltf) => {\n\n      // this.mixer= new AnimationMixer(gltf.scene)\n      // var action=this.mixer.clipAction(gltf.animations[0])\n      // // action.timeScale=0.8\n      // action.time=4\n      gltf.scene.traverse((object) => {\n        if ((object as Mesh).isMesh) {\n          // 修改模型的材质\n          object.castShadow = true;\n          object.frustumCulled = false;\n          // object.receiveShadow = true;\n\n          (object as any).material.emissive = (object as any).material.color;\n          (object as any).material.emissiveMap = (object as any).material.map;\n        }\n      })\n      gltf.scene.receiveShadow = true\n      this.model = gltf.scene\n      this.scene.add(gltf.scene)\n      this.character.add(gltf.scene)\n      gltf.scene.position.set(5, 0, -8)\n      console.log(this.model)\n\n    }, () => { }, (e) => { console.log(\"error\", e) })\n\n  }\n\n  loadRoom() {\n    const loader: GLTFLoader = new GLTFLoader()\n\n    loader.load('/abandoned_factory/scene.gltf', (gltf) => {\n\n      // this.mixer= new AnimationMixer(gltf.scene)\n      // var action=this.mixer.clipAction(gltf.animations[0])\n      // // action.timeScale=0.8\n      // action.time=4\n      gltf.scene.traverse((object) => {\n        if ((object as Mesh).isMesh) {\n          // 修改模型的材质\n          object.castShadow = true;\n          object.frustumCulled = false;\n          // object.receiveShadow = true;\n\n          (object as any).material.emissive = (object as any).material.color;\n          (object as any).material.emissiveMap = (object as any).material.map;\n        }\n      })\n      gltf.scene.receiveShadow = true\n\n      this.scene.add(gltf.scene)\n      gltf.scene.scale.set(30, 30, 30)\n      gltf.scene.position.set(0, 100, 0)\n\n    }, () => { }, (e) => { console.log(\"error\", e) })\n\n  }\n  addObject(...object: Object3D[]) {\n    object.forEach(elem => {\n      this.scene.add(elem)\n    })\n  }\n  setRotate(a: number, b: number, g: number) {\n    if (g > 0) {\n      if (b < 0) {\n        b = -180 - b\n      } else {\n        b = 180 - b\n      }\n\n    }\n    a = a % 180;\n    if (g < 0) {\n      g = g + 180\n    }\n    if (!this.model) return\n    this.model.rotation.z = (90 - g + 10) / 180 * Math.PI\n\n    if(this.platform==='linux'){\n      if (a > 35 && a < 85) {\n        this.model.rotation.y = (a / 360 * 2 * Math.PI);\n        this.camera.rotation.y = (a / 360 * 2 * Math.PI)\n        if (this.rotateStepID > 0) {\n          clearInterval(this.rotateStepID)\n          this.rotateStepID = -1\n        }\n  \n      } else if (a > 85 && a < 180) {\n        if (!this.rotateStepID || this.rotateStepID < 0) {\n          this.rotateStepID = setInterval(() => {\n            this.character.rotation.y += Math.PI / 180;\n          }, 10)\n        }\n  \n  \n  \n      } else if (a < 35 || a > 300) {\n        if (!this.rotateStepID || this.rotateStepID < 0) {\n          this.rotateStepID = setInterval(() => {\n            this.character.rotation.y -= Math.PI / 180;\n          }, 10)\n        }\n      }\n  \n      if (b < 25 && b > -25) {\n        this.model.rotation.x = (b / 360 * 2 * Math.PI);\n        if (this.motionStepID > 0) {\n          clearInterval(this.motionStepID);\n          this.motionStepID = -1\n        }\n      }\n  \n  \n      if (b < -25 || b > 25) {\n        if (!this.motionStepID || this.motionStepID < 0) {\n          this.motionStepID = setInterval(() => {\n            this.character.position.x += this.target.x;\n            // this.camera.position.x+=this.target.x;\n            this.character.position.z += this.target.z;\n          }, 10)\n        }\n  \n        // this.model.position.x+=this.target.x;\n        // this.model.position.z+=this.target.z;\n  \n        // \n        // console.log(this.target)\n      }\n      // this.model.rotation.z=(g/360*2*Math.PI);\n    }else{\n      this.model.rotation.y = (a / 360 * 2 * Math.PI);\n      if (b < 25 && b > -25) {\n        this.model.rotation.x = (b / 360 * 2 * Math.PI);\n        if (this.motionStepID > 0) {\n          clearInterval(this.motionStepID);\n          this.motionStepID = -1\n        }\n      }\n  \n  \n      if (b < -25 || b > 25) {\n        if (!this.motionStepID || this.motionStepID < 0) {\n          this.motionStepID = setInterval(() => {\n            this.character.position.x += this.target.x;\n            // this.camera.position.x+=this.target.x;\n            this.character.position.z += this.target.z;\n          }, 10)\n        }\n  \n        // this.model.position.x+=this.target.x;\n        // this.model.position.z+=this.target.z;\n  \n        // \n        // console.log(this.target)\n      }\n      // this.model.rotation.z=(g/360*2*Math.PI);\n    }\n\n  }\n\n  disableControls() {\n    this.controls.enabled = false\n  }\n  enableControls() {\n    this.controls.enabled = true\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}
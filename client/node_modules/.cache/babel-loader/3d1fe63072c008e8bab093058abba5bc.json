{"ast":null,"code":"var _jsxFileName = \"/home/malf/code/game-demo/client/src/App.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { TEngine } from \"./TEngine/TEngine\";\nimport socket from \"./Socket/index\";\nimport './App.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction getPlatform() {\n  var info = navigator.userAgent; //通过正则表达式的test方法判断是否包含“Mobile”字符串\n\n  var isPhone = /mobile/i.test(info); //如果包含“Mobile”（是手机设备）则返回true\n\n  return isPhone;\n}\n\nfunction App() {\n  _s();\n\n  const [alpha, setAlpha] = useState(0);\n  const [beta, setBeta] = useState(0);\n  const [gamma, setGamma] = useState(0);\n  const [dtype, setdtype] = useState(0);\n\n  function get(event) {\n    let a = event.alpha;\n    let b = event.beta;\n    let g = event.gamma;\n    setAlpha(a.toFixed(2));\n    setBeta(b.toFixed(2));\n    setGamma(g.toFixed(2));\n    let t = {\n      a,\n      b,\n      g\n    };\n    socket.emit('orientation', t);\n  }\n\n  useEffect(() => {\n    if (dtype === 1) {\n      window.addEventListener('deviceorientation', get);\n    } else if (dtype === 2) {\n      window.removeEventListener('deviceorientation', get);\n      const threeTarget = document.querySelector(\".canvas-three\");\n      const TE = new TEngine(threeTarget);\n      TE.loadGun();\n      TE.loadRoom();\n      socket.on('getdata', event => {\n        // console.log('getdata',event)\n        let {\n          a,\n          b,\n          g\n        } = event;\n        TE.setRotate(a, b, g);\n        setAlpha(a.toFixed(2));\n        setBeta(b.toFixed(2));\n        setGamma(g.toFixed(2));\n      });\n      window.addEventListener(\"keydown\", e => {\n        if (e.keyCode === 27) {\n          TE.disableControls();\n        } else if (e.keyCode === 17) {\n          TE.enableControls();\n        }\n      });\n    }\n  }, [dtype]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"info\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"\\u5DE6\\u53F3\\uFF1A\", alpha]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"\\u524D\\u540E\\uFF1A\", beta]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"\\u626D\\u8F6C\\uFF1A\", gamma]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"weaponbtn\",\n        onClick: e => {\n          let dom = e.target;\n\n          if (dtype === 0) {\n            setdtype(1);\n            dom.innerHTML = '切换为环境';\n          } else if (dtype === 1) {\n            setdtype(2);\n            dom.innerHTML = '切换为环境';\n          } else if (dtype === 2) {\n            setdtype(1);\n            dom.innerHTML = '切换为武器';\n          }\n        },\n        children: \"\\u6B66\\u5668\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 1\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"canvas-three\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: getPlatform()\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 66,\n    columnNumber: 5\n  }, this);\n}\n\n_s(App, \"1+Hf9F7HdRWdRJBPTG9nblMTe5A=\");\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useEffect","useState","TEngine","socket","getPlatform","info","navigator","userAgent","isPhone","test","App","alpha","setAlpha","beta","setBeta","gamma","setGamma","dtype","setdtype","get","event","a","b","g","toFixed","t","emit","window","addEventListener","removeEventListener","threeTarget","document","querySelector","TE","loadGun","loadRoom","on","setRotate","e","keyCode","disableControls","enableControls","dom","target","innerHTML"],"sources":["/home/malf/code/game-demo/client/src/App.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { TEngine } from \"./TEngine/TEngine\"\nimport socket from \"./Socket/index\"\nimport './App.css';\nfunction getPlatform() {\n\n  var info = navigator.userAgent;\n  //通过正则表达式的test方法判断是否包含“Mobile”字符串\n  var isPhone = /mobile/i.test(info);\n  //如果包含“Mobile”（是手机设备）则返回true\n  return isPhone\n}\nfunction App() {\n  const [alpha, setAlpha] = useState(0)\n  const [beta, setBeta] = useState(0)\n  const [gamma, setGamma] = useState(0)\n  const [dtype, setdtype] = useState(0)\n  function get(event: any) {\n\n    let a = event.alpha;\n    let b = event.beta;\n    let g = event.gamma;\n    setAlpha(a.toFixed(2))\n    setBeta(b.toFixed(2))\n    setGamma(g.toFixed(2))\n    let t={a,b,g}\n    socket.emit('orientation',t)\n  }\n  useEffect(() => {\n    if (dtype===1) {\n      \n      window.addEventListener('deviceorientation',get )\n    } else if(dtype===2){\n      window.removeEventListener('deviceorientation',get)\n      const threeTarget = document.querySelector(\".canvas-three\")\n      const TE = new TEngine(threeTarget as HTMLDivElement)\n      TE.loadGun()\n      TE.loadRoom()\n      socket.on('getdata',(event:any)=>{\n        // console.log('getdata',event)\n        let {a,b,g}=event\n        TE.setRotate(a, b, g)\n        setAlpha(a.toFixed(2))\n        setBeta(b.toFixed(2))\n        setGamma(g.toFixed(2))\n      })\n      window.addEventListener(\"keydown\", (e) => {\n        if (e.keyCode === 27) {\n  \n          TE.disableControls()\n  \n        } else if (e.keyCode === 17) {\n          TE.enableControls()\n        }\n      })\n    }\n      \n    \n\n\n    \n\n  }, [dtype])\n\n  return (\n    <div className=\"App\">\n<div className='info'>\n        <div>左右：{\n        alpha\n      }</div>\n      <div>前后：{\n        beta\n      }</div>\n      <div>扭转：{\n        gamma\n      }</div>\n      <div className='weaponbtn' onClick={(e)=>{\n        let dom=e.target as HTMLDivElement;\n        if(dtype===0){\n          setdtype(1)\n          dom.innerHTML='切换为环境'\n        }else if(dtype===1){\n          setdtype(2)\n          dom.innerHTML='切换为环境'\n        }else if( dtype===2){\n          setdtype(1)\n          dom.innerHTML='切换为武器'\n\n        }\n       \n      }}>武器</div>\n</div>\n\n      <div className='canvas-three'></div>\n      <div>{getPlatform()}</div>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}